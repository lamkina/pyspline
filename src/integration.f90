subroutine gaussianQuadrature(f, n, a, b, val)
    use precision
    implicit none

    ! Input
    integer, intent(in) :: n
    real(kind=realType), intent(in) :: a, b
    external :: f

    ! Output
    real(kind=realType), intent(out) :: val

    ! Working
    real(kind=realType) :: t(n), wa(n), x(n), w(n), temp
    integer :: i

    call gaussPointsWeights()

    t = (b - a) * x / 2.0 + (b + a) / 2.0
    wa = (b - a) / 2.0 * w

    val = 0.0
    do i = 1, n
        call f(t(i), temp)
        val = val + wa(i) * temp
    end do

contains

    subroutine gaussPointsWeights()
        implicit none

        select case (n)
        case (1)
            x(1) = 0.0
            w(1) = 2.0
        case (2)
            x(1) = -0.577350269189625764509148780502
            x(2) = -x(1)
            w(1) = 1.0
            w(2) = 1.0
        case (3)
            x(1) = -0.774596669241483377035853079956
            x(2) = 0.0
            x(3) = -x(1)
            w(1) = 0.555555555555555555555555555556
            w(2) = 0.888888888888888888888888888889
            w(3) = w(1)
        case (4)
            x(1) = -0.861136311594052575223946488893
            x(2) = -0.339981043584856264802665759103
            x(3) = -x(2)
            x(4) = -x(1)
            w(1) = 0.347854845137453857373063949222
            w(2) = 0.652145154862546142626936050778
            w(3) = w(2)
            w(4) = w(1)
        case (32)
            x(1) = -0.0483076656877383162348125704405021636908
            x(2) = 0.04830766568773831623481257044050216369084
            x(3) = -0.1444719615827964934851863735988106522038
            x(4) = 0.14447196158279649348518637359881065220384
            x(5) = -0.2392873622521370745446032091655015206088
            x(6) = 0.23928736225213707454460320916550152060885
            x(7) = -0.3318686022821276497799168057301879961957
            x(8) = 0.33186860228212764977991680573018799619577
            x(9) = -0.4213512761306353453641194361724264783358
            x(10) = 0.4213512761306353453641194361724264783358
            x(11) = -0.506899908932229390023747474377821230180
            x(12) = 0.5068999089322293900237474743778212301802
            x(13) = -0.587715757240762329040745476401826858450
            x(14) = 0.5877157572407623290407454764018268584509
            x(15) = -0.663044266930215200975115168663238368977
            x(16) = 0.6630442669302152009751151686632383689770
            x(17) = -0.732182118740289680387426665091267146630
            x(18) = 0.7321821187402896803874266650912671466302
            x(19) = -0.794483795967942406963097298970428902095
            x(20) = 0.7944837959679424069630972989704289020954
            x(21) = -0.849367613732569970133693004967742538954
            x(22) = 0.8493676137325699701336930049677425389548
            x(23) = -0.896321155766052123965307243719212268478
            x(24) = 0.8963211557660521239653072437192122684789
            x(25) = -0.934906075937739689170919134835409325528
            x(26) = 0.9349060759377396891709191348354093255286
            x(27) = -0.964762255587506430773811928118274960388
            x(28) = 0.9647622555875064307738119281182749603888
            x(29) = -0.985611511545268335400175044630901978632
            x(30) = 0.9856115115452683354001750446309019786323
            x(31) = -0.997263861849481563544981128665040727138
            x(32) = 0.9972638618494815635449811286650407271385
            w(1) = 0.0965400885147278005667648300635757947368
            w(2) = 0.0965400885147278005667648300635757947368
            w(3) = 0.0956387200792748594190820022041311005948
            w(4) = 0.0956387200792748594190820022041311005948
            w(5) = 0.0938443990808045656391802376681172600361
            w(6) = 0.0938443990808045656391802376681172600361
            w(7) = 0.0911738786957638847128685771116370625448
            w(8) = 0.0911738786957638847128685771116370625448
            w(9) = 0.0876520930044038111427714627518022875484
            w(10) = 0.0876520930044038111427714627518022875484
            w(11) = 0.0833119242269467552221990746043486115387
            w(12) = 0.0833119242269467552221990746043486115387
            w(13) = 0.0781938957870703064717409188283066710397
            w(14) = 0.0781938957870703064717409188283066710397
            w(15) = 0.0723457941088485062253993564784877916043
            w(16) = 0.0723457941088485062253993564784877916043
            w(17) = 0.0658222227763618468376500637069387728775
            w(18) = 0.0658222227763618468376500637069387728775
            w(19) = 0.0586840934785355471452836373001708867501
            w(20) = 0.0586840934785355471452836373001708867501
            w(21) = 0.0509980592623761761961632446895216952601
            w(22) = 0.0509980592623761761961632446895216952601
            w(23) = 0.0428358980222266806568786466061255284928
            w(24) = 0.0428358980222266806568786466061255284928
            w(25) = 0.0342738629130214331026877322523727069948
            w(26) = 0.0342738629130214331026877322523727069948
            w(27) = 0.0253920653092620594557525897892240292875
            w(28) = 0.0253920653092620594557525897892240292875
            w(29) = 0.0162743947309056706051705622063866181795
            w(30) = 0.0162743947309056706051705622063866181795
            w(31) = 0.0070186100094700966004070637388531825133
            w(32) = 0.0070186100094700966004070637388531825133
        case (64)
            x(1) = -0.024350292663424432508955842853715661426
            x(2) = 0.0243502926634244325089558428537156614268
            x(3) = -0.072993121787799039449542941940337493244
            x(4) = 0.0729931217877990394495429419403374932441
            x(5) = -0.121462819296120554470376463492247878218
            x(6) = 0.1214628192961205544703764634922478782186
            x(7) = -0.169644420423992818037313629748269844199
            x(8) = 0.1696444204239928180373136297482698441999
            x(9) = -0.217423643740007084149648748988822617578
            x(10) = 0.2174236437400070841496487489888226175784
            x(11) = -0.264687162208767416373964172510020117980
            x(12) = 0.2646871622087674163739641725100201179804
            x(13) = -0.311322871990210956157512698560156883557
            x(14) = 0.3113228719902109561575126985601568835577
            x(15) = -0.357220158337668115950442615046202531626
            x(16) = 0.3572201583376681159504426150462025316262
            x(17) = -0.402270157963991603695766771260158848713
            x(18) = 0.4022701579639916036957667712601588487132
            x(19) = -0.446366017253464087984947714758915189206
            x(20) = 0.4463660172534640879849477147589151892067
            x(21) = -0.489403145707052957478526307021921390849
            x(22) = 0.4894031457070529574785263070219213908493
            x(23) = -0.531279464019894545658013903544455247408
            x(24) = 0.5312794640198945456580139035444552474085
            x(25) = -0.571895646202634034283878116659188643183
            x(26) = 0.5718956462026340342838781166591886431831
            x(27) = -0.611155355172393250248852971018548918696
            x(28) = 0.6111553551723932502488529710185489186961
            x(29) = -0.648965471254657339857761231993404885529
            x(30) = 0.6489654712546573398577612319934048855296
            x(31) = -0.685236313054233242563558371031376301935
            x(32) = 0.6852363130542332425635583710313763019356
            x(33) = -0.719881850171610826848940217831947244758
            x(34) = 0.7198818501716108268489402178319472447581
            x(35) = -0.752819907260531896611863774885693985551
            x(36) = 0.7528199072605318966118637748856939855517
            x(37) = -0.783972358943341407610220525213768284056
            x(38) = 0.7839723589433414076102205252137682840564
            x(39) = -0.813265315122797559741923338086303340698
            x(40) = 0.8132653151227975597419233380863033406981
            x(41) = -0.840629296252580362751691544695873302982
            x(42) = 0.8406292962525803627516915446958733029824
            x(43) = -0.865999398154092819760783385070157502412
            x(44) = 0.8659993981540928197607833850701575024125
            x(45) = -0.889315445995114105853404038272851622429
            x(46) = 0.8893154459951141058534040382728516224291
            x(47) = -0.910522137078502805756380668008329861013
            x(48) = 0.9105221370785028057563806680083298610134
            x(49) = -0.929569172131939575821490154559225607347
            x(50) = 0.9295691721319395758214901545592256073474
            x(51) = -0.946411374858402816062481491347264795279
            x(52) = 0.9464113748584028160624814913472647952793
            x(53) = -0.961008799652053718918614121897157206762
            x(54) = 0.9610087996520537189186141218971572067621
            x(55) = -0.973326827789910963741853507352272668026
            x(56) = 0.9733268277899109637418535073522726680261
            x(57) = -0.983336253884625956931299302156831116945
            x(58) = 0.9833362538846259569312993021568311169452
            x(59) = -0.991013371476744320739382383443303113641
            x(60) = 0.9910133714767443207393823834433031136413
            x(61) = -0.996340116771955279346924500676399123209
            x(62) = 0.9963401167719552793469245006763991232098
            x(63) = -0.999305041735772139456905624345636311969
            x(64) = 0.9993050417357721394569056243456363119697
            w(1) = 0.0486909570091397203833653907347499124426
            w(2) = 0.0486909570091397203833653907347499124426
            w(3) = 0.0485754674415034269347990667839781136875
            w(4) = 0.0485754674415034269347990667839781136875
            w(5) = 0.0483447622348029571697695271580178097036
            w(6) = 0.0483447622348029571697695271580178097036
            w(7) = 0.0479993885964583077281261798713460699543
            w(8) = 0.0479993885964583077281261798713460699543
            w(9) = 0.0475401657148303086622822069442231716408
            w(10) = 0.0475401657148303086622822069442231716408
            w(11) = 0.0469681828162100173253262857545810751998
            w(12) = 0.0469681828162100173253262857545810751998
            w(13) = 0.0462847965813144172959532492322611849696
            w(14) = 0.0462847965813144172959532492322611849696
            w(15) = 0.0454916279274181444797709969712690588873
            w(16) = 0.0454916279274181444797709969712690588873
            w(17) = 0.0445905581637565630601347100309448432940
            w(18) = 0.0445905581637565630601347100309448432940
            w(19) = 0.0435837245293234533768278609737374809227
            w(20) = 0.0435837245293234533768278609737374809227
            w(21) = 0.0424735151236535890073397679088173661655
            w(22) = 0.0424735151236535890073397679088173661655
            w(23) = 0.0412625632426235286101562974736380477399
            w(24) = 0.0412625632426235286101562974736380477399
            w(25) = 0.0399537411327203413866569261283360739186
            w(26) = 0.0399537411327203413866569261283360739186
            w(27) = 0.0385501531786156291289624969468089910127
            w(28) = 0.0385501531786156291289624969468089910127
            w(29) = 0.0370551285402400460404151018095833750834
            w(30) = 0.0370551285402400460404151018095833750834
            w(31) = 0.0354722132568823838106931467152459479480
            w(32) = 0.0354722132568823838106931467152459479480
            w(33) = 0.0338051618371416093915654821107254310210
            w(34) = 0.0338051618371416093915654821107254310210
            w(35) = 0.0320579283548515535854675043478987169662
            w(36) = 0.0320579283548515535854675043478987169662
            w(37) = 0.0302346570724024788679740598195486591582
            w(38) = 0.0302346570724024788679740598195486591582
            w(39) = 0.0283396726142594832275113052002373519812
            w(40) = 0.0283396726142594832275113052002373519812
            w(41) = 0.0263774697150546586716917926252251856755
            w(42) = 0.0263774697150546586716917926252251856755
            w(43) = 0.0243527025687108733381775504090689876499
            w(44) = 0.0243527025687108733381775504090689876499
            w(45) = 0.0222701738083832541592983303841550024229
            w(46) = 0.0222701738083832541592983303841550024229
            w(47) = 0.0201348231535302093723403167285438970895
            w(48) = 0.0201348231535302093723403167285438970895
            w(49) = 0.0179517157756973430850453020011193688971
            w(50) = 0.0179517157756973430850453020011193688971
            w(51) = 0.0157260304760247193219659952975397944260
            w(52) = 0.0157260304760247193219659952975397944260
            w(53) = 0.0134630478967186425980607666859556841084
            w(54) = 0.0134630478967186425980607666859556841084
            w(55) = 0.0111681394601311288185904930192081350727
            w(56) = 0.0111681394601311288185904930192081350727
            w(57) = 0.0088467598263639477230309146597306476951
            w(58) = 0.0088467598263639477230309146597306476951
            w(59) = 0.0065044579689783628561173603999812667711
            w(60) = 0.0065044579689783628561173603999812667711
            w(61) = 0.0041470332605624676352875357285514153133
            w(62) = 0.0041470332605624676352875357285514153133
            w(63) = 0.0017832807216964329472960791449719331799
            w(64) = 0.0017832807216964329472960791449719331799
        end select
    end subroutine gaussPointsWeights
end subroutine gaussianQuadrature
